{
  "service": {
    "specVersion": "v3",
    "catalog_metadata": {
      "name": "jke-multi-cloud",
      "description": "Deploy JKE application on multiple cloud environments",
      "image": "serviceicon_1.svg",
      "category": "CloudServices",
      "bullets": [],
      "providerDisplayName": "IBM",
      "longDescription": "",
      "documentationUrl": "",
      "supportUrl": "",
      "bindable": false,
      "updatable": "",
      "systemTags": true,
      "author": "admin"
    },
    "tags": [
      {
        "name": "Request_Group",
        "label": "Request_Group",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "The current context group id of the current user that requested the provisioning of the template. This is important because a user may be part of more than one group and this identifies the context of which group the user made the request.",
        "isSystemTag": true,
        "default": "${svc_instance.group}",
        "customtype": "string",
        "permission": "Read-Only"
      },
      {
        "name": "Request_User",
        "label": "Request_User",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "The user id of the current user that requested the provisioning of the template.",
        "isSystemTag": true,
        "default": "${svc_instance.owner}",
        "customtype": "string",
        "permission": "Read-Only"
      },
      {
        "name": "Service_Name",
        "label": "Service_Name",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "Name provided for the service instance by the end user at time of request",
        "isSystemTag": true,
        "default": "${svc_instance.name}",
        "customtype": "string",
        "permission": "Read-Only"
      },
      {
        "name": "Service_Identifier",
        "label": "Service_Identifier",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "Unique identifer generated by ICAM which is mapped to the service instance of the template provisioned.",
        "isSystemTag": true,
        "default": "${svc_instance.service_instance_id}",
        "customtype": "string",
        "permission": "Read-Only"
      }
    ],
    "actions": [
      {
        "type": "provision",
        "name": "Provision",
        "description": "Default action for deployment of service",
        "input_parameters": [
          {
            "name": "cloud_env",
            "label": "cloud_env",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "options": [
              {
                "value": "vra",
                "label": "vra"
              },
              {
                "value": "aws",
                "label": "aws"
              }
            ]
          },
          {
            "name": "web_server_password",
            "label": "Web server password",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "Root password for web server",
            "default": ""
          },
          {
            "name": "db_server_password",
            "label": "DB server password",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "Root password for DB server",
            "default": ""
          }
        ],
        "flow": {
          "conditions": [
            {
              "decision": {
                "title": "cloud_env",
                "options": [
                  {
                    "case": "vra",
                    "sequence": {
                      "0": "vrainfra69b72e50",
                      "1": "jkeappond425f9c2"
                    }
                  },
                  {
                    "case": "aws",
                    "sequence": {
                      "0": "awsmysqlfe0fca96",
                      "1": "jkeappon12e4e34f"
                    }
                  }
                ],
                "id": "decisionb1878221",
                "mapped_parameter": "${input_parameters.cloud_env}"
              }
            }
          ],
          "templates": [
            {
              "vra-infra-mw": {
                "title": "vra-infra-mw",
                "template_name": "vra-infra-mw",
                "version": "master",
                "id": "vrainfra69b72e50",
                "template_type": "Terraform",
                "template_content_type": "Other",
                "template_provider": "Other",
                "instance_name": "vra-mw-1",
                "cloud_connection_name": "Other",
                "template_data_objects": {
                  "vra_credentials_data": "vra3"
                },
                "template_params": {
                  "vra_username": "${vra_credentials_data.vra_user}",
                  "vra_password": "${vra_credentials_data.vra_password}",
                  "vra_tenant": "${vra_credentials_data.vra_tenant}",
                  "vra_host": "${vra_credentials_data.vra_host}",
                  "vra_insecure": "true",
                  "cmh_vcenter_two_node_2_timeout": "15",
                  "web-server_user": "root",
                  "web-server_password": "${input_parameters.web_server_password}",
                  "db-server_user": "root",
                  "db-server_password": "${input_parameters.db_server_password}"
                },
                "outputs": [
                  "vra7-db-server-ip",
                  "vra7-web-server-ip"
                ]
              }
            },
            {
              "JKE-app-only-pw": {
                "title": "JKE-app-only-pw_bca001",
                "template_name": "JKE-app-only-pw",
                "version": "master",
                "id": "jkeappond425f9c2",
                "template_type": "Terraform",
                "template_content_type": "Other",
                "template_provider": "Other",
                "instance_name": "",
                "cloud_connection_name": "Other",
                "template_data_objects": {
                  "ucd_credentials_data": "ucd_icdemo3"
                },
                "template_params": {
                  "ucd_user": "${ucd_credentials_data.ucd_user}",
                  "ucd_password": "${ucd_credentials_data.ucd_password}",
                  "ucd_server_url": "${ucd_credentials_data.ucd_host}",
                  "environment_name": "jke-env-cam-${svc_instance.name}",
                  "db-server_agent_name": "jke-db-${svc_instance.name}",
                  "web-server_agent_name": "jke-web-${svc_instance.name}",
                  "web-server-public-ip-address": "${templates.vrainfra69b72e50.output.vra7-web-server-ip}",
                  "db-server-public-ip-address": "${templates.vrainfra69b72e50.output.vra7-db-server-ip}",
                  "web-server-user": "root",
                  "db-server-user": "root",
                  "web-server_password": "${input_parameters.web_server_password}",
                  "db-server_password": "${input_parameters.db_server_password}"
                },
                "outputs": [
                  "jke_app_url"
                ]
              }
            },
            {
              "aws-mysql-liberty-two-node": {
                "title": "aws-mysql-liberty-two-node_4c8620",
                "template_name": "aws-mysql-liberty-two-node",
                "version": "master",
                "id": "awsmysqlfe0fca96",
                "template_type": "Terraform",
                "template_content_type": "Amazon EC2",
                "template_provider": "Amazon EC2",
                "instance_name": "",
                "cloud_connection_name": "cmh-aws",
                "template_data_objects": {
                  "aws_cloud": "us-east-1-aws"
                },
                "template_params": {
                  "db-server_ami": "${aws_cloud.centos_ami}",
                  "db-server_aws_instance_type": "${aws_cloud.instance_type}",
                  "availability_zone": "${aws_cloud.availability_zone}",
                  "db-server_name": "db-server",
                  "web-server_ami": "${aws_cloud.ubuntu_ami}",
                  "web-server_aws_instance_type": "${aws_cloud.instance_type}",
                  "web-server_name": "web-server",
                  "group_name": "${aws_cloud.group_name}",
                  "vpc_id": "${aws_cloud.vpc_id}",
                  "web-server-user": "ubuntu",
                  "db-server-user": "centos"
                },
                "outputs": [
                  "web_server_ip_address",
                  "db_server_ip_address",
                  "tls-private-key",
                  "web-server-user",
                  "db-server-user"
                ]
              }
            },
            {
              "JKE-app-only": {
                "title": "JKE-app-only_1cbfb6",
                "template_name": "JKE-app-only",
                "version": "master",
                "id": "jkeappon12e4e34f",
                "template_type": "Terraform",
                "template_content_type": "Other",
                "template_provider": "Other",
                "instance_name": "",
                "cloud_connection_name": "Other",
                "template_data_objects": {
                  "ucd_credentials_data": "ucd_icdemo3"
                },
                "template_params": {
                  "ucd_user": "${ucd_credentials_data.ucd_user}",
                  "ucd_password": "${ucd_credentials_data.ucd_password}",
                  "ucd_server_url": "${ucd_credentials_data.ucd_host}",
                  "environment_name": "jke-env-cam-${svc_instance.name}",
                  "db-server_agent_name": "jke-db-${svc_instance.name}",
                  "web-server_agent_name": "jke-web-${svc_instance.name}",
                  "web-server-public-ip-address": "${templates.awsmysqlfe0fca96.output.web_server_ip_address}",
                  "db-server-public-ip-address": "${templates.awsmysqlfe0fca96.output.db_server_ip_address}",
                  "web-server-private-ssh-key": "${templates.awsmysqlfe0fca96.output.tls-private-key}",
                  "db-server-private-ssh-key": "${templates.awsmysqlfe0fca96.output.tls-private-key}",
                  "web-server-user": "ubuntu",
                  "db-server-user": "centos"
                },
                "outputs": [
                  "jke_app_url"
                ]
              }
            }
          ],
          "resthooks": [],
          "notifications": [],
          "sequence": {
            "0": "decisionb1878221"
          },
          "error_sequence": {}
        },
        "output_parameters": []
      }
    ],
    "plans": [
      {
        "name": "vra",
        "description": "Deploy app and mw into VRA infra",
        "actions": [],
        "plan_parameters": [
          {
            "name": "cloud_env",
            "label": "cloud_env",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": true,
            "secured": false,
            "default": "vra"
          },
          {
            "name": "web_server_password",
            "label": "Web server password",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "Root password for web server",
            "default": "VRApassw0rd"
          },
          {
            "name": "db_server_password",
            "label": "DB server password",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "Root password for DB server",
            "default": "VRApassw0rd"
          }
        ]
      },
      {
        "name": "aws",
        "description": "Deploy mw and app into AWS infra",
        "plan_parameters": [
          {
            "name": "cloud_env",
            "label": "cloud_env",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": true,
            "secured": false,
            "default": "aws"
          },
          {
            "name": "web_server_password",
            "label": "Web server password",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": true,
            "secured": false,
            "description": "Root password for web server",
            "default": "none"
          },
          {
            "name": "db_server_password",
            "label": "DB server password",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": true,
            "secured": false,
            "description": "Root password for DB server",
            "default": "none"
          }
        ]
      }
    ]
  }
}